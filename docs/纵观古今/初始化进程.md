---
title: 初始化进程
toc: true
date: 2018-04-19 07:31:11
tags:
	- sysvinit
	- systemd
categories:
---

# sysvinit

内核文件加载以后，开始运行第一个程序 /sbin/init，进程编号（pid）就是1。其他所有进程都从它衍生，都是它的子进程

## 初衷

准备软件运行的环境，包括系统的主机名称、网络配置、语系处理、文件系统格式及其他服务的启动等
<!--more-->
## 实现

所有的init配置都在/etc/inittab文件当中

### 运行级别

#### 初衷

操作系统启动时根据"运行级别"，确定要运行哪些程序及服务。依据有无网络与有无 X Window 而将 run level 分为 7 个等级

- 0 - halt (系统直接关机)
- 1 - single user mode (单人维护模式，用在系统出问题时的维护)
- 2 - Multi-user, without NFS (类似底下的 runlevel 3，但无 NFS 服务)
- 3 - Full multi-user mode (完整含有网络功能的纯文字模式)
- 4 - unused (系统保留功能)
- 5 - X11 (与 runlevel 3 类似，但加载使用 X Window)
- 6 - reboot (重新启动)

#### 实现

每个运行级别在/etc目录下面，都有一个对应的子目录，指定要加载的程序

> /etc/rcS.d/ #开机后需要自动启动的一些基本服务
> /etc/rc0.d/ #运行模式0下需要启动的服务
> /etc/rc1.d/ #运行模式1下需要启动的服务
> /etc/rc2.d/ #运行模式2下需要启动的服务
> /etc/rc3.d/ #运行模式3下需要启动的服务
> /etc/rc4.d/ #运行模式4下需要启动的服务
> /etc/rc5.d/ #运行模式5下需要启动的服务
> /etc/rc6.d/ #运行模式6下需要启动的服务

> S01console-setup.sh -> ../init.d/console-setup.sh
> S01cron -> ../init.d/cron
> S01irqbalance -> ../init.d/irqbalance
> S01rsyslog -> ../init.d/rsyslog
> S01ssh -> ../init.d/ssh

文件名都是"字母S+两位数字+程序名"的形式,字母S表示Start,字母K表示Kill,后面的两位数字表示处理顺序,数字越小越早处理

##### /etc/init.d

启动脚本都统一放在这个目录中,而rcN.d只是链接到该目录

# systemd

参见:[Systemd (简体中文)](https://wiki.archlinux.org/index.php/systemd_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29)


# 参考资料
> - [鸟哥的linux私房菜](http://cn.linux.vbird.org/linux_basic/0510osloader_1.php)
> - [Systemd (简体中文)](https://wiki.archlinux.org/index.php/systemd_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29)
> - [Linux 的启动流程](http://www.ruanyifeng.com/blog/2013/08/linux_boot_process.html)
> - [linux init.d 脚本的解释](https://www.jianshu.com/p/5af068656d4b)



